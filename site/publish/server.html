
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2018-06-10
 Rendered using Reflow Maven Skin 1.1.0 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Phoenix Query Server | Apache Phoenix</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="//netdna.bootstrapcdn.com/bootswatch/2.3.2/flatly/bootstrap.min.css" rel="stylesheet" />
		<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/bootswatch.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />

		<link href="//yandex.st/highlightjs/7.5/styles/default.min.css" rel="stylesheet" />
		
		<link href="./css/lightbox.css" rel="stylesheet" />
		
		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->



	</head>

	<body class="page-server project-phoenix-site" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="index.html"><div class="xtoplogo"></div></a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="index.html" title="Overview">Overview</a></li>
									<li ><a href="who_is_using.html" title="Who is Using">Who is Using</a></li>
									<li ><a href="recent.html" title="Recent Improvements">Recent Improvements</a></li>
									<li ><a href="roadmap.html" title="Roadmap">Roadmap</a></li>
									<li ><a href="news.html" title="News">News</a></li>
									<li ><a href="performance.html" title="Performance">Performance</a></li>
									<li ><a href="team.html" title="Team">Team</a></li>
									<li ><a href="resources.html" title="Presentations">Presentations</a></li>
									<li ><a href="mailing_list.html" title="Mailing Lists">Mailing Lists</a></li>
									<li ><a href="source.html" title="Source Repository">Source Repository</a></li>
									<li ><a href="issues.html" title="Issue Tracking">Issue Tracking</a></li>
									<li ><a href="download.html" title="Download">Download</a></li>
									<li ><a href="installation.html" title="Installation">Installation</a></li>
									<li class="divider"/>
									<li ><a href="contributing.html" title="How to Contribute">How to Contribute</a></li>
									<li ><a href="develop.html" title="How to Develop">How to Develop</a></li>
									<li ><a href="building_website.html" title="How to Update Website">How to Update Website</a></li>
									<li ><a href="release.html" title="How to Release">How to Release</a></li>
									<li class="divider"/>
									<li ><a href="http://www.apache.org/licenses/" title="License" class="externalLink">License</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Using <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="faq.html" title="F.A.Q.">F.A.Q.</a></li>
									<li ><a href="Phoenix-in-15-minutes-or-less.html" title="Quick Start">Quick Start</a></li>
									<li ><a href="building.html" title="Building">Building</a></li>
									<li ><a href="tuning_guide.html" title="Tuning">Tuning</a></li>
									<li ><a href="explainplan.html" title="Explain Plan">Explain Plan</a></li>
									<li ><a href="tuning.html" title="Configuration">Configuration</a></li>
									<li ><a href="upgrading.html" title="Backward Compatibility">Backward Compatibility</a></li>
									<li ><a href="release_notes.html" title="Release Notes">Release Notes</a></li>
									<li ><a href="pherf.html" title="Performance Testing">Performance Testing</a></li>
									<li class="divider"/>
									<li ><a href="phoenix_spark.html" title="Apache Spark Integration">Apache Spark Integration</a></li>
									<li ><a href="hive_storage_handler.html" title="Phoenix Storage Handler for Apache Hive">Phoenix Storage Handler for Apache Hive</a></li>
									<li ><a href="pig_integration.html" title="Apache Pig Integration">Apache Pig Integration</a></li>
									<li ><a href="phoenix_mr.html" title="Map Reduce Integration">Map Reduce Integration</a></li>
									<li ><a href="flume.html" title="Apache Flume Plugin">Apache Flume Plugin</a></li>
									<li ><a href="kafka.html" title="Apache Kafka Plugin">Apache Kafka Plugin</a></li>
									<li ><a href="python.html" title="Python Driver">Python Driver</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Addons <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="http://docs.aws.amazon.com/ElasticMapReduce/latest/ReleaseGuide/emr-phoenix.html" title="Phoenix on Amazon EMR" class="externalLink">Phoenix on Amazon EMR</a></li>
									<li ><a href="http://python-phoenixdb.readthedocs.io/en/latest" title="Phoenix Adapter for Python" class="externalLink">Phoenix Adapter for Python</a></li>
									<li ><a href="phoenix_orm.html" title="Phoenix ORM Library">Phoenix ORM Library</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Features <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="transactions.html" title="Transactions">Transactions</a></li>
									<li ><a href="udf.html" title="User-defined Functions">User-defined Functions</a></li>
									<li class="divider"/>
									<li ><a href="secondary_indexing.html" title="Secondary Indexes">Secondary Indexes</a></li>
									<li ><a href="columnencoding.html" title="Storage Formats">Storage Formats</a></li>
									<li ><a href="atomic_upsert.html" title="Atomic Upsert">Atomic Upsert</a></li>
									<li ><a href="namspace_mapping.html" title="Namespace Mapping">Namespace Mapping</a></li>
									<li ><a href="update_statistics.html" title="Statistics Collection">Statistics Collection</a></li>
									<li ><a href="rowtimestamp.html" title="Row Timestamp Column">Row Timestamp Column</a></li>
									<li ><a href="paged.html" title="Paged Queries">Paged Queries</a></li>
									<li ><a href="salted.html" title="Salted Tables">Salted Tables</a></li>
									<li ><a href="skip_scan.html" title="Skip Scan">Skip Scan</a></li>
									<li ><a href="tablesample.html" title="Table Sampling">Table Sampling</a></li>
									<li class="divider"/>
									<li ><a href="views.html" title="Views">Views</a></li>
									<li ><a href="multi-tenancy.html" title="Multi tenancy">Multi tenancy</a></li>
									<li ><a href="dynamic_columns.html" title="Dynamic Columns">Dynamic Columns</a></li>
									<li class="divider"/>
									<li ><a href="bulk_dataload.html" title="Bulk Loading">Bulk Loading</a></li>
									<li class="active"><a href="" title="Query Server">Query Server</a></li>
									<li ><a href="metrics.html" title="Metrics">Metrics</a></li>
									<li ><a href="tracing.html" title="Tracing">Tracing</a></li>
									<li ><a href="cursors.html" title="Cursor">Cursor</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="language/index.html" title="Grammar">Grammar</a></li>
									<li ><a href="language/functions.html" title="Functions">Functions</a></li>
									<li ><a href="language/datatypes.html" title="Datatypes">Datatypes</a></li>
									<li ><a href="array_type.html" title="ARRAY type">ARRAY type</a></li>
									<li class="divider"/>
									<li ><a href="sequences.html" title="Sequences">Sequences</a></li>
									<li ><a href="joins.html" title="Joins">Joins</a></li>
									<li ><a href="subqueries.html" title="Subqueries">Subqueries</a></li>
									<li ><a href="explainplan.html" title="Explain Plan">Explain Plan</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->

	<header>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<div class="page-header">
 <h1>Phoenix Query Server</h1>
</div> 
<p>The Phoenix Query Server provides an alternative means for interaction with Phoenix and HBase. Soon this will enable access from environments other than the JVM.</p> 
<div class="section"> 
 <h2 id="Overview">Overview</h2> 
 <p>Phoenix 4.4 introduces a stand-alone server that exposes Phoenix to “thin” clients. It is based on the <a class="externalLink" href="https://calcite.apache.org/avatica">Avatica</a> component of <a class="externalLink" href="https://calcite.apache.org">Apache Calcite</a>. The query server is comprised of a Java server that manages Phoenix Connections on the clients’ behalf. The client implementation is currently a JDBC driver with minimal dependencies. Two transport mechanisms are current supported: JSON and Protocol Buffers (available as of Phoenix 4.7 as the default). There’s also a sqlline script that uses the thin client.</p> 
 <p>Avatica is still relatively early in its life-cycle. With the introduction of the Protobuf transport, Avatica is moving towards backwards compatibility with the provided thin JDBC driver. There are no such backwards compatibility guarantees for the JSON API.</p> 
 <p>To repeat, there is no guarantee of backwards compatibility with the JSON transport; however, compatibility with the Protobuf transport is stabilizing (although, not tested thoroughly enough to be stated as “guaranteed”).</p> 
</div> 
<div class="section"> 
 <h2 id="Installation">Installation</h2> 
 <p>The query server and its JDBC client are part of the standard Phoenix distribution. They require no additional dependencies.</p> 
</div> 
<div class="section"> 
 <h2 id="Usage">Usage</h2> 
 <div class="section"> 
  <h3 id="Server">Server</h3> 
  <p>The server component is managed through <tt>bin/queryserver.py</tt>. Its usage is as follows</p> 
  <div class="source"> 
   <pre>bin/queryserver.py [start|stop]
</pre> 
  </div> 
  <p>When invoked with no arguments, the query server is launched in the foreground, with logging directed to the console.</p> 
  <p>The first argument is an optional <tt>start</tt> or <tt>stop</tt> command to the daemon. When either of these are provided, it will take appropriate action on a daemon process, if it exists.</p> 
  <p>Any subsequent arguments are passed to the main class for interpretation.</p> 
  <p>The server is packaged in a standalone jar, <tt>phoenix-server-&lt;version&gt;-runnable.jar</tt>. This jar and <tt>HBASE_CONF_DIR</tt> on the classpath are all that is required to launch the server.</p> 
 </div> 
 <div class="section"> 
  <h3 id="Client">Client</h3> 
  <p>Phoenix provides two mechanisms for interacting with the query server. A JDBC driver is provided in the standalone <tt>phoenix-&lt;version&gt;-thin-client.jar</tt>. The script <tt>bin/sqlline-thin.py</tt> is available for the command line.</p> 
  <p>The JDBC connection string is composed as follows:</p> 
  <div class="source"> 
   <pre>jdbc:phoenix:thin:url=&lt;scheme&gt;://&lt;server-hostname&gt;:&lt;port&gt;[;option=value...]
</pre> 
  </div> 
  <p><tt>&lt;scheme&gt;</tt> specifies the transport protocol used when communicating with the server. The only supported transport at this time is <tt>http</tt>.</p> 
  <p><tt>&lt;server-hostname&gt;</tt> is the name of the host offering the service.</p> 
  <p><tt>&lt;port&gt;</tt> is the port number on which the host is listening. Default is <tt>8765</tt>, though this is configurable (see below).</p> 
  <p>A full list of options that can be provided via the JDBC URL string is <a href="#jdbc_url_options">available in the below table</a></p> 
  <p>The script <tt>bin/sqlline-thin.py</tt> is intended to behave identically to its sibling script <tt>bin/sqlline.py</tt>. It supports the following usage options.</p> 
  <div class="source"> 
   <pre>bin/sqlline-thin.py [[scheme://]host[:port]] [sql_file]
</pre> 
  </div> 
  <p>The first optional argument is a connection URL, as described previously. When not provided, <tt>scheme</tt> defaults to <tt>http</tt>, <tt>host</tt> to <tt>localhost</tt>, and <tt>port</tt> to <tt>8765</tt>.</p> 
  <div class="source"> 
   <pre>bin/sqlline-thin.py http://localhost:8765
</pre> 
  </div> 
  <p>The second optional parameter is a sql file from which to read commands.</p> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Wire_API_documentation">Wire API documentation</h2> 
 <p>The API itself is documented in the Apache Calcite project as it is the Avatica API – there is no wire API defined in Phoenix itself.</p> 
 <p><a class="externalLink" href="http://calcite.apache.org/avatica/docs/json_reference.html">JSON API</a></p> 
 <p><a class="externalLink" href="http://calcite.apache.org/avatica/docs/protobuf_reference.html">Protocol Buffer API</a></p> 
 <p>For more information in building clients in other languages that work with Avatica, please feel free to reach out to the <a class="externalLink" href="mailto:dev@calcite.apache.org">Apache Calcite dev mailing list</a>.</p> 
</div> 
<div class="section"> 
 <h2 id="Impersonation">Impersonation</h2> 
 <p>By default, the Phoenix Query Server executes queries on behalf of the end-user. HBase permissions are enforced given the end-user, not the Phoenix Query Server’s identity. In some cases, it may be desirable to execute the query as some other user – this is referred to as “impersonation”. This can enable workflows where a trusted user has the privilege to run queries for other users.</p> 
 <p>This can be enabled by setting the configuration property <tt>phoenix.queryserver.withRemoteUserExtractor</tt> to <tt>true</tt>. The URL of the Query Server can be modified to include the required request parameter. For example, to let “bob” to run a query as “alice”, the following JDBC URL could be used:</p> 
 <div class="source"> 
  <pre>jdbc:phoenix:thin:url=http://localhost:8765?doAs=alice
</pre> 
 </div> 
 <p>The standard Hadoop “proxyuser” configuration keys are checked to validate if the “real” remote user is allowed to impersonate the “doAs” user. See the <a class="externalLink" href="https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-common/Superusers.html">Hadoop documentation</a> for more information on how to configure these rules.</p> 
 <p>As a word of warning: there is no end-to-end test coverage for the HBase 0.98 and 1.1 Phoenix releases because of missing test-related code in those HBase releases. While we expect no issues on these Phoenix release lines, we recommend additional testing by the user to verify that there are no issues.</p> 
</div> 
<div class="section"> 
 <h2 id="Configuration">Configuration</h2> 
 <p>Server components are spread across a number of java packages, so effective logging configuration requires updating multiple packages. The default server logging configuration sets the following log levels:</p> 
 <div class="source"> 
  <pre>log4j.logger.org.apache.calcite.avatica=INFO
log4j.logger.org.apache.phoenix.queryserver.server=INFO
log4j.logger.org.eclipse.jetty.server=INFO
</pre> 
 </div> 
 <p>As of the time of this writing, the underlying Avatica component respects the following configuration options. They are exposed via <tt>hbase-site.xml</tt> configuration.</p> 
 <table class="bodyTable table table-striped table-hover" border="1"> 
  <tbody> 
   <tr class="a"> 
    <td colspan="3"><b>Configurations relating to the server instantiation.</b></td> 
   </tr> 
   <tr class="b"> 
    <td><b>Property</b></td> 
    <td><b>Description</b></td> 
    <td><b>Default</b></td> 
   </tr> 
   <tr class="a"> 
    <td><small>phoenix.queryserver.http.port</small></td> 
    <td style="text-align: left;">Specifies a port the server will listen on. Default is 8765.</td> 
    <td>8765</td> 
   </tr> 
   <tr class="b"> 
    <td><small>phoenix.queryserver.metafactory.class</small></td> 
    <td style="text-align: left;">The Avatica Meta.Factory class to instantiate.</td> 
    <td>org.apache.phoenix.queryserver.server.PhoenixMetaFactoryImpl</td> 
   </tr> 
   <tr class="a"> 
    <td><small>phoenix.queryserver.serialization</small></td> 
    <td style="text-align: left;">The transport/serialization format, either PROTOBUF or JSON.</td> 
    <td>PROTOBUF</td> 
   </tr> 
   <tr class="b"> 
    <td colspan="3">&nbsp;</td> 
   </tr> 
   <tr class="a"> 
    <td colspan="3"><b>Configurations relating to server connecting to a secure cluster.</b></td> 
   </tr> 
   <tr class="b"> 
    <td><b>Property</b></td> 
    <td><b>Description</b></td> 
    <td><b>Default</b></td> 
   </tr> 
   <tr class="a"> 
    <td><small>hbase.security.authentication</small></td> 
    <td style="text-align: left;">When set to &quot;kerberos&quot;, the server will attempt to log in before initiating Phoenix connections.</td> 
    <td><i>Specified hbase-default.xml</i></td> 
   </tr> 
   <tr class="b"> 
    <td><small>phoenix.queryserver.keytab.file</small></td> 
    <td style="text-align: left;">The key to look for keytab file.</td> 
    <td><i>unset</i></td> 
   </tr> 
   <tr class="a"> 
    <td><small>phoenix.queryserver.kerberos.principal</small></td> 
    <td style="text-align: left;">The kerberos principal to use when authenticating. If phoenix.queryserver.kerberos.http.principal is not configured, this principal specified will be also used to both authenticate SPNEGO connections and to connect to HBase.</td> 
    <td><i>unset</i></td> 
   </tr> 
   <tr class="b"> 
    <td><small>phoenix.queryserver.http.keytab.file</small></td> 
    <td style="text-align: left;">The keytab file to use for authenticating SPNEGO connections. This configuration MUST be specified if phoenix.queryserver.kerberos.http.principal is configured. phoenix.queryserver.keytab.file will be used if this property is undefined.</td> 
    <td><i>unset</i></td> 
   </tr> 
   <tr class="a"> 
    <td><small>phoenix.queryserver.http.kerberos.principal</small></td> 
    <td style="text-align: left;">The kerberos principal to use when authenticating SPNEGO connections. phoenix.queryserver.kerberos.principal will be used if this property is undefined.</td> 
    <td><i>unset</i></td> 
   </tr> 
   <tr class="b"> 
    <td><small>phoenix.queryserver.kerberos.http.principal</small></td> 
    <td style="text-align: left;">Deprecated, use phoenix.queryserver.http.kerberos.principal instead.</td> 
    <td><i>unset</i></td> 
   </tr> 
   <tr class="a"> 
    <td><small>phoenix.queryserver.kerberos.allowed.realms</small></td> 
    <td style="text-align: left;">A comma-separated list of Kerberos realms, other than that of the PQS's HTTP principal's realm, that should be allowed to authenticate with PQS via SPNEGO.</td> 
    <td><i>unset</i></td> 
   </tr> 
   <tr class="b"> 
    <td><small>phoenix.queryserver.dns.nameserver</small></td> 
    <td style="text-align: left;">The DNS hostname</td> 
    <td>default</td> 
   </tr> 
   <tr class="a"> 
    <td><small>phoenix.queryserver.dns.interface</small></td> 
    <td style="text-align: left;">The name of the network interface to query for DNS.</td> 
    <td>default</td> 
   </tr> 
   <tr class="b"> 
    <td colspan="3">&nbsp;</td> 
   </tr> 
   <tr class="a"> 
    <td colspan="3"><b>Configurations relating to the server connection cache.</b></td> 
   </tr> 
   <tr class="b"> 
    <td><b>Property</b></td> 
    <td><b>Description</b></td> 
    <td><b>Default</b></td> 
   </tr> 
   <tr class="a"> 
    <td><small>avatica.connectioncache.concurrency</small></td> 
    <td style="text-align: left;">Connection cache concurrency level. Default is 10.</td> 
    <td>10</td> 
   </tr> 
   <tr class="b"> 
    <td><small>avatica.connectioncache.initialcapacity</small></td> 
    <td style="text-align: left;">Connection cache initial capacity. Default is 100.</td> 
    <td>100</td> 
   </tr> 
   <tr class="a"> 
    <td><small>avatica.connectioncache.maxcapacity</small></td> 
    <td style="text-align: left;"> Connection cache maximum capacity. Approaching this point, the cache will start to evict least recently used connection objects. Default is 1000. </td> 
    <td>1000</td> 
   </tr> 
   <tr class="b"> 
    <td><small>avatica.connectioncache.expiryduration</small></td> 
    <td style="text-align: left;"> Connection cache expiration duration. Any connections older than this value will be discarded. Default is 10 minutes. </td> 
    <td>10</td> 
   </tr> 
   <tr class="a"> 
    <td><small>avatica.connectioncache.expiryunit</small></td> 
    <td style="text-align: left;"> Connection cache expiration unit. Unit modifier applied to the value provided in avatica.connectioncache.expiryunit. Default is minutes. </td> 
    <td>MINUTES</td> 
   </tr> 
   <tr class="b"> 
    <td colspan="3">&nbsp;</td> 
   </tr> 
   <tr class="a"> 
    <td colspan="3" id="jdbc_url_options"><b>JDBC URL options.</b></td> 
   </tr> 
   <tr class="b"> 
    <td><small>url</small></td> 
    <td style="text-align: left;"> The URL of the QueryServer. </td> 
    <td>null</td> 
   </tr> 
   <tr class="a"> 
    <td><small>serialization</small></td> 
    <td style="text-align: left;"> The client-side analogy to phoenix.queryserver.serialization in the server to control how the client should serialize data to send to the QueryServer. </td> 
    <td>PROTOBUF</td> 
   </tr> 
   <tr class="b"> 
    <td><small>timeZone</small></td> 
    <td style="text-align: left;"> The time zone the JDBC connection should use. If not provided, the time zone will be specified by JVM. The value of this should be parseable by Java's TimeZone class. </td> 
    <td>null</td> 
   </tr> 
   <tr class="a"> 
    <td colspan="3">&nbsp;</td> 
   </tr> 
   <tr class="b"> 
    <td colspan="3"><b>Configurations relating to the server statement cache.</b></td> 
   </tr> 
   <tr class="a"> 
    <td><b>Property</b></td> 
    <td><b>Description</b></td> 
    <td><b>Default</b></td> 
   </tr> 
   <tr class="b"> 
    <td><small>avatica.statementcache.concurrency</small></td> 
    <td style="text-align: left;">Statement cache concurrency level. Default is 100.</td> 
    <td>100</td> 
   </tr> 
   <tr class="a"> 
    <td><small>avatica.statementcache.initialcapacity</small></td> 
    <td style="text-align: left;">Statement cache initial capacity. Default is 1000.</td> 
    <td>1000</td> 
   </tr> 
   <tr class="b"> 
    <td><small>avatica.statementcache.maxcapacity</small></td> 
    <td style="text-align: left;"> Statement cache maximum capacity. Approaching this point, the cache will start to evict least recently used statement objects. Default is 10000. </td> 
    <td>10000</td> 
   </tr> 
   <tr class="a"> 
    <td><small>avatica.statementcache.expiryduration</small></td> 
    <td style="text-align: left;"> Statement cache expiration duration. Any statements older than this value will be discarded. Default is 5 minutes. </td> 
    <td>5</td> 
   </tr> 
   <tr class="b"> 
    <td><small>avatica.statementcache.expiryunit</small></td> 
    <td style="text-align: left;"> Statement cache expiration unit. Unit modifier applied to the value provided in avatica.statementcache.expiryunit. Default is minutes. </td> 
    <td>MINUTES</td> 
   </tr> 
   <tr class="a"> 
    <td colspan="3">&nbsp;</td> 
   </tr> 
   <tr class="b"> 
    <td colspan="3"><b>Configurations relating to impersonation.</b></td> 
   </tr> 
   <tr class="a"> 
    <td><b>Property</b></td> 
    <td><b>Description</b></td> 
    <td><b>Default</b></td> 
   </tr> 
   <tr class="b"> 
    <td><small>phoenix.queryserver.withRemoteUserExtractor</small></td> 
    <td style="text-align: left;"> Boolean which controls if a remote user to impersonate should be extracted from the HTTP request parameter made by that user instead of the HTTP-authenticated user name (which is the default). </td> 
    <td>false</td> 
   </tr> 
   <tr class="a"> 
    <td><small>phoenix.queryserver.remoteUserExtractor.param</small></td> 
    <td style="text-align: left;"> The name of the HTTP request parameter to use to extract the user name to execute the query as. </td> 
    <td>doAs</td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<div class="section"> 
 <h2 id="Query_Server_Additions">Query Server Additions</h2> 
 <p>The Phoenix Query Server is meant to be horizontally scalable which means that it is a natural fit add-on features like service discovery and load balancing.</p> 
 <div class="section"> 
  <h3 id="Load_balancing">Load balancing</h3> 
  <p>The Query Server can use off-the-shelf HTTP load balancers such as the <a class="externalLink" href="https://httpd.apache.org">Apache HTTP Server</a>, <a class="externalLink" href="https://nginx.org">nginx</a>, or <a class="externalLink" href="https://haproxy.org">HAProxy</a>. The primary requirement of using these load balancers is that the implementation must implement “sticky session” (when a client communicates with a backend server, that client continues to talk to that backend server). The Query Server also provides some bundled functionality for load balancing using ZooKeeper.</p> 
  <p>The ZooKeeper-based load balancer functions by automatically registering PQS instances in ZooKeeper and then allows clients to query the list of available servers. This implementation, unlike the others mentioned above, requires that client use the advertised information to make a routing decision. In this regard, this ZooKeeper-based approach is more akin to a service-discovery layer than a traditional load balancer. This load balancer implementation does <i>not</i> support SASL-based (Kerberos) ACLs in ZooKeeper (see <a class="externalLink" href="https://issues.apache.org/jira/browse/PHOENIX-4085">PHOENIX-4085</a>).</p> 
  <p>The following are configuration properties used to configure this load balancer:</p> 
  <table class="bodyTable table table-striped table-hover" border="1"> 
   <tbody> 
    <tr class="a"> 
     <td colspan="3"><b>Configurations relating to the ZooKeeper-based load balancer.</b></td> 
    </tr> 
    <tr class="b"> 
     <td><b>Property</b></td> 
     <td><b>Description</b></td> 
     <td><b>Default</b></td> 
    </tr> 
    <tr class="a"> 
     <td><small>phoenix.queryserver.loadbalancer.enabled</small></td> 
     <td style="text-align: left;">Should PQS register itself in ZooKeeper for the load balancer.</td> 
     <td>false</td> 
    </tr> 
    <tr class="b"> 
     <td><small>phoenix.queryserver.base.path</small></td> 
     <td style="text-align: left;">Root znode the PQS instance should register itself to.</td> 
     <td>/phoenix</td> 
    </tr> 
    <tr class="a"> 
     <td><small>phoenix.queryserver.service.name</small></td> 
     <td style="text-align: left;">A unique name to identify this PQS instance from others.</td> 
     <td>queryserver</td> 
    </tr> 
    <tr class="b"> 
     <td><small>phoenix.queryserver.zookeeper.acl.username</small></td> 
     <td style="text-align: left;">Name to set for a DIGEST ZooKeeper ACL, optional.</td> 
     <td>phoenix</td> 
    </tr> 
    <tr class="a"> 
     <td><small>phoenix.queryserver.zookeeper.acl.password</small></td> 
     <td style="text-align: left;">Password to set for a DIGEST ZooKeeper ACL, optional.</td> 
     <td>phoenix</td> 
    </tr> 
   </tbody> 
  </table> 
 </div> 
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">About</li>
						<li >
							<a href="index.html" title="Overview">Overview</a>
						</li>
						<li >
							<a href="who_is_using.html" title="Who is Using">Who is Using</a>
						</li>
						<li >
							<a href="recent.html" title="Recent Improvements">Recent Improvements</a>
						</li>
						<li >
							<a href="roadmap.html" title="Roadmap">Roadmap</a>
						</li>
						<li >
							<a href="news.html" title="News">News</a>
						</li>
						<li >
							<a href="performance.html" title="Performance">Performance</a>
						</li>
						<li >
							<a href="team.html" title="Team">Team</a>
						</li>
						<li >
							<a href="resources.html" title="Presentations">Presentations</a>
						</li>
						<li >
							<a href="mailing_list.html" title="Mailing Lists">Mailing Lists</a>
						</li>
						<li >
							<a href="source.html" title="Source Repository">Source Repository</a>
						</li>
						<li >
							<a href="issues.html" title="Issue Tracking">Issue Tracking</a>
						</li>
						<li >
							<a href="download.html" title="Download">Download</a>
						</li>
						<li >
							<a href="installation.html" title="Installation">Installation</a>
						</li>
						<li >
							<a href="http:divider" title=""></a>
						</li>
						<li >
							<a href="contributing.html" title="How to Contribute">How to Contribute</a>
						</li>
						<li >
							<a href="develop.html" title="How to Develop">How to Develop</a>
						</li>
						<li >
							<a href="building_website.html" title="How to Update Website">How to Update Website</a>
						</li>
						<li >
							<a href="release.html" title="How to Release">How to Release</a>
						</li>
						<li >
							<a href="http:divider" title=""></a>
						</li>
						<li >
							<a href="http://www.apache.org/licenses/" title="License" class="externalLink">License</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Using</li>
						<li >
							<a href="faq.html" title="F.A.Q.">F.A.Q.</a>
						</li>
						<li >
							<a href="Phoenix-in-15-minutes-or-less.html" title="Quick Start">Quick Start</a>
						</li>
						<li >
							<a href="building.html" title="Building">Building</a>
						</li>
						<li >
							<a href="tuning_guide.html" title="Tuning">Tuning</a>
						</li>
						<li >
							<a href="explainplan.html" title="Explain Plan">Explain Plan</a>
						</li>
						<li >
							<a href="tuning.html" title="Configuration">Configuration</a>
						</li>
						<li >
							<a href="upgrading.html" title="Backward Compatibility">Backward Compatibility</a>
						</li>
						<li >
							<a href="release_notes.html" title="Release Notes">Release Notes</a>
						</li>
						<li >
							<a href="pherf.html" title="Performance Testing">Performance Testing</a>
						</li>
						<li >
							<a href="http:divider" title=""></a>
						</li>
						<li >
							<a href="phoenix_spark.html" title="Apache Spark Integration">Apache Spark Integration</a>
						</li>
						<li >
							<a href="hive_storage_handler.html" title="Phoenix Storage Handler for Apache Hive">Phoenix Storage Handler for Apache Hive</a>
						</li>
						<li >
							<a href="pig_integration.html" title="Apache Pig Integration">Apache Pig Integration</a>
						</li>
						<li >
							<a href="phoenix_mr.html" title="Map Reduce Integration">Map Reduce Integration</a>
						</li>
						<li >
							<a href="flume.html" title="Apache Flume Plugin">Apache Flume Plugin</a>
						</li>
						<li >
							<a href="kafka.html" title="Apache Kafka Plugin">Apache Kafka Plugin</a>
						</li>
						<li >
							<a href="python.html" title="Python Driver">Python Driver</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Features</li>
						<li >
							<a href="transactions.html" title="Transactions">Transactions</a>
						</li>
						<li >
							<a href="udf.html" title="User-defined Functions">User-defined Functions</a>
						</li>
						<li >
							<a href="http:divider" title=""></a>
						</li>
						<li >
							<a href="secondary_indexing.html" title="Secondary Indexes">Secondary Indexes</a>
						</li>
						<li >
							<a href="columnencoding.html" title="Storage Formats">Storage Formats</a>
						</li>
						<li >
							<a href="atomic_upsert.html" title="Atomic Upsert">Atomic Upsert</a>
						</li>
						<li >
							<a href="namspace_mapping.html" title="Namespace Mapping">Namespace Mapping</a>
						</li>
						<li >
							<a href="update_statistics.html" title="Statistics Collection">Statistics Collection</a>
						</li>
						<li >
							<a href="rowtimestamp.html" title="Row Timestamp Column">Row Timestamp Column</a>
						</li>
						<li >
							<a href="paged.html" title="Paged Queries">Paged Queries</a>
						</li>
						<li >
							<a href="salted.html" title="Salted Tables">Salted Tables</a>
						</li>
						<li >
							<a href="skip_scan.html" title="Skip Scan">Skip Scan</a>
						</li>
						<li >
							<a href="tablesample.html" title="Table Sampling">Table Sampling</a>
						</li>
						<li >
							<a href="http:divider" title=""></a>
						</li>
						<li >
							<a href="views.html" title="Views">Views</a>
						</li>
						<li >
							<a href="multi-tenancy.html" title="Multi tenancy">Multi tenancy</a>
						</li>
						<li >
							<a href="dynamic_columns.html" title="Dynamic Columns">Dynamic Columns</a>
						</li>
						<li >
							<a href="http:divider" title=""></a>
						</li>
						<li >
							<a href="bulk_dataload.html" title="Bulk Loading">Bulk Loading</a>
						</li>
						<li class="active">
							<a href="#" title="Query Server">Query Server</a>
						</li>
						<li >
							<a href="metrics.html" title="Metrics">Metrics</a>
						</li>
						<li >
							<a href="tracing.html" title="Tracing">Tracing</a>
						</li>
						<li >
							<a href="cursors.html" title="Cursor">Cursor</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Reference</li>
						<li >
							<a href="language/index.html" title="Grammar">Grammar</a>
						</li>
						<li >
							<a href="language/functions.html" title="Functions">Functions</a>
						</li>
						<li >
							<a href="language/datatypes.html" title="Datatypes">Datatypes</a>
						</li>
						<li >
							<a href="array_type.html" title="ARRAY type">ARRAY type</a>
						</li>
						<li >
							<a href="http:divider" title=""></a>
						</li>
						<li >
							<a href="sequences.html" title="Sequences">Sequences</a>
						</li>
						<li >
							<a href="joins.html" title="Joins">Joins</a>
						</li>
						<li >
							<a href="subqueries.html" title="Subqueries">Subqueries</a>
						</li>
						<li >
							<a href="explainplan.html" title="Explain Plan">Explain Plan</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-description">
					<form action="http://search-hadoop.com/?" method="get"><input value="Phoenix" name="fc_project" type="hidden"><input placeholder="Search Phoenix&hellip;" required="required" style="width:170px;" size="18" name="q" id="query" type="search"></form>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2018 <a href="http://www.apache.org">Apache Software Foundation</a>. All Rights Reserved.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	
	<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.js"></script>
	<script src="./js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="./js/jquery.ba-bbq.min.js"></script>
	<script src="//yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>
	
	</body>
</html>
